/*********************************************************************
*
*   NAME:
*       graphics_main.cpp
*
*   DESCRIPTION:
*       main thread for graphics processing
*
*   Copyright 2022 Nate Lenze
*
*********************************************************************/

/*--------------------------------------------------------------------
                           GENERAL INCLUDES
--------------------------------------------------------------------*/
#include "graphics_main.hpp"

/*--------------------------------------------------------------------
                          LITERAL CONSTANTS
--------------------------------------------------------------------*/

/*--------------------------------------------------------------------
                                TYPES
--------------------------------------------------------------------*/

/*--------------------------------------------------------------------
                           MEMORY CONSTANTS
--------------------------------------------------------------------*/

/*--------------------------------------------------------------------
                              VARIABLES
--------------------------------------------------------------------*/
static screen*current_screen = nullptr;

/*--------------------------------------------------------------------
                                MACROS
--------------------------------------------------------------------*/

/*--------------------------------------------------------------------
                              PROCEDURES
--------------------------------------------------------------------*/
/*********************************************************************
*
*   PROCEDURE NAME:
*       graphics_init
*
*   DESCRIPTION:
*       initilaizes graphic static variables
*
*********************************************************************/
void graphics_init( screen *init_s ){
    current_screen = init_s;
}

/*********************************************************************
*
*   PROCEDURE NAME:
*       graphics_main
*
*   DESCRIPTION:
*       runs and processes all graphics events
*
*********************************************************************/
void graphics_main
    (
    std::queue<graphics_msg>& events 
    )
{
/*----------------------------------------------------------
Local variables
----------------------------------------------------------*/

/*----------------------------------------------------------
Draw Phase
----------------------------------------------------------*/
BeginDrawing();

/*----------------------------------------------------------
Proccess outstanding events
----------------------------------------------------------*/

while( !events.empty() )
    {
    current_screen->handleGraphicEvent( events.front() );
    events.pop();
    }

/*----------------------------------------------------------
Draw screen
----------------------------------------------------------*/
current_screen->drawBackground();

EndDrawing();
}